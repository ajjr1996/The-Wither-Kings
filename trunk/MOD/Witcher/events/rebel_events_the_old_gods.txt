#########################################################
#
# Rebel Events for The Old Gods DLC
# ( TOG.1000 to TOG.1199)
#
# NOTE: The Old Gods DLC disables the old rebel system
#
#########################################################

# Written by Henrik Fåhraeus

namespace = TOG

# Peasant Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from "on_rebel_revolt"
province_event = {
	id = TOG.1000
	desc = EVTDESC_TOG_1000
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		has_dlc = "The Old Gods"
		
		# Heretic revolts have prio
		OR = {
			is_heretic = no
			owner = {
				top_liege = {
					NOT = { is_parent_religion = ROOT }
				}
			}
		}
		
		# Nationalist revolts have prio
		OR = {
			owner = {
				top_liege = {
					culture = ROOT
				}
			}
			kingdom = {
				OR = {
					has_holder = yes
					NOT = { culture = ROOT }
				}
			}
		}
		
		NOT = { # Not if there is already an ongoing peasant revolt for this province
			owner = {
				top_liege = {
					war = yes
					
					any_war = {
						defender = { character = PREV }
						OR = {
							AND = {
								using_cb = peasant_revolt
								war_title = ROOT # The county
							}
							AND = {
								using_cb = heretic_revolt
								attacker = { religion = ROOT }
							}
							AND = {
								using_cb = liberation_revolt
								thirdparty_title_scope = {
									ROOT = {
										kingdom = {
											title = PREVPREV
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
			attributes = {
				martial = 5
			}
			trait = peasant_leader
			trait = tough_soldier
		}
		
		new_character = {
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "PEASANT_REVOLT"
				holder = THIS
			}
			
			random_list = {
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 1.0
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.0
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.0
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.66
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.66
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.66
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 1.0
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.0
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.0
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.66
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.66
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.66
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 1.0
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.0
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.0
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.66
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.66
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.66
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
						}
					}
				}
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
#						set_defacto_vassal = PREVPREVPREV
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = peasant_revolt
							thirdparty_title = ROOT # The county
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1001
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

character_event = {
	id = TOG.1001
	desc = EVTDESC_TOG_1001
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

# Peasants seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = TOG.1005
	picture = GFX_evt_siege
	
	hide_window = yes
	is_triggered_only = yes
	
	desc = OK
	
	trigger = {
		trait = peasant_leader
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { has_province_modifier = peasant_unrest }
					}
					add_province_modifier = {
						name = peasant_unrest
						duration = 730
					}
				}
			}
		}
	}
	
	option = {
		name = OK
	}
}

# Peasant Rebels rise up to reinforce an ongoing provincial peasant revolt
# Triggered from "on_rebel_revolt"
province_event = {
	id = TOG.1010
	desc = EVTDESC_TOG_1010
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		has_dlc = "The Old Gods"
		
		# There is already an ongoing peasant revolt for this province
		owner = {
			top_liege = {
				war = yes
				any_war = {
					defender = { character = PREV }
					using_cb = peasant_revolt
					war_title = ROOT # The county
				}
			}
		}
	}
	
	immediate = {
		
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = peasant_revolt
						war_title = ROOT # The county
					}
					attacker = {
						random_list = {
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.0
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.66
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
							}
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1011
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

character_event = {
	id = TOG.1011
	desc = EVTDESC_TOG_1011
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

# Heretic Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from "on_rebel_revolt"
province_event = {
	id = TOG.1020
	desc = EVTDESC_TOG_1020
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		has_dlc = "The Old Gods"
		
		is_heretic = yes
		
		owner = {
			top_liege = {
				is_parent_religion = ROOT
			}
		}
		
		NOT = { # Not if there is already an ongoing revolt
			owner = {
				top_liege = {
					war = yes
					any_war = {
						defender = { character = PREV }
						OR = {
							AND = {
								using_cb = peasant_revolt
								war_title = ROOT # The county
							}
							AND = {
								using_cb = heretic_revolt
								attacker = { religion = ROOT }
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 32
			attributes = {
				martial = 7
				learning = 7
			}
			trait = heresiarch
			trait = zealous
			trait = scholar
			trait = skilled_tactician
		}
		
		new_character = {
			set_character_flag = heretic_revolter
			
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "HERETIC_REVOLT"
				holder = THIS
			}
			
			random_list = {
				34 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 1.34
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.33
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 23
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.33
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
						}
					}
				}
				33 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 1.34
						troops = {
							archers = { 6 6 }
							light_cavalry = { 2 2 }
							light_infantry = { 12 12 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.33
							troops = {
								archers = { 6 6 }
								light_cavalry = { 2 2 }
								light_infantry = { 12 12 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 23
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.33
							troops = {
								archers = { 6 6 }
								light_cavalry = { 2 2 }
								light_infantry = { 12 12 }
							}
							attrition = 1.0
						}
					}
				}
				33 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 1.34
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.33
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 23
						trait = peasant_leader
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 1.33
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
						}
					}
				}
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = heretic_revolt
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1021
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1020"
	}
}

character_event = {
	id = TOG.1021
	desc = EVTDESC_TOG_1021
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TOG_1020
	}
}

# Heretics seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = TOG.1025
	picture = GFX_evt_siege
	
	hide_window = yes
	is_triggered_only = yes
	
	desc = OK
	
	trigger = {
		trait = heresiarch
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { religion = ROOT }
					}
					random = {
						chance = 50
						religion = ROOT
					}
				}
				if = {
					limit = {
						NOT = { has_province_modifier = religious_unrest }
					}
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
			}
		}
	}
	
	option = {
		name = OK
	}
}

# Heretic Rebels rise up to reinforce an ongoing heretic uprising
# Triggered from "on_rebel_revolt"
province_event = {
	id = TOG.1030
	desc = EVTDESC_TOG_1030
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		has_dlc = "The Old Gods"
		
		is_heretic = yes
		
		owner = {
			top_liege = {
				is_parent_religion = ROOT
			}
		}
		
		owner = {
			top_liege = {
				war = yes
				any_war = {
					defender = { character = PREV }
					using_cb = heretic_revolt
					attacker = { religion = ROOT }
				}
			}
		}
	}
	
	immediate = {
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = heretic_revolt
						attacker = { religion = ROOT }
					}
					attacker = {
						random_list = {
							34 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.34
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.33
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 23
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.33
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
							}
							33 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.34
										troops = {
											archers = { 6 6 }
											light_cavalry = { 2 2 }
											light_infantry = { 12 12 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.33
										troops = {
											archers = { 6 6 }
											light_cavalry = { 2 2 }
											light_infantry = { 12 12 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 23
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.33
										troops = {
											archers = { 6 6 }
											light_cavalry = { 2 2 }
											light_infantry = { 12 12 }
										}
										attrition = 1.0
									}
								}
							}
							33 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.34
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.33
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 23
									trait = peasant_leader
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 1.33
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
							}
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1031
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1030"
	}
}

character_event = {
	id = TOG.1031
	desc = EVTDESC_TOG_1031
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1030"
	}
}

# Royalist Nationalist Rebels rise up to create a kingdom (temporary rebel title created, with a leader and a war)
# Triggered from "on_rebel_revolt"
province_event = {
	id = TOG.1040
	desc = EVTDESC_TOG_1040
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		has_dlc = "The Old Gods"
		
		owner = {
			top_liege = {
				NOT = { culture = ROOT }
			}
		}
		
		kingdom = {
			has_holder = no
			culture = ROOT
			any_previous_holder = {
				always = yes # Must have had a holder in the past
			}
		}
		
		# Heretic revolts have prio
		OR = { 
			is_heretic = no
			owner = {
				top_liege = {
					NOT = { is_parent_religion = ROOT }
				}
			}
		}
		
		NOT = { # Not if there is already an ongoing revolt
			owner = {
				top_liege = {
					war = yes
					any_war = {
						defender = { character = PREV }
						OR = {
							AND = {
								using_cb = heretic_revolt
								attacker = { religion = ROOT }
							}
							AND = {
								using_cb = liberation_revolt
								thirdparty_title_scope = {
									ROOT = {
										kingdom = {
											title = PREVPREV
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = random
			religion = ROOT
			culture = ROOT
			female = no
			age = 20
			health = 7
			fertility = 0.7
			attributes = {
				martial = 8
				diplomacy = 9
			}
			trait = just
			trait = brave
			trait = gregarious
			trait = ambitious
			trait = brilliant_strategist
			trait = inspiring_leader
		}
		
		new_character = {
			set_character_flag = nationalist_rebel
			
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "NATIONALIST_REVOLT"
				holder = THIS
			}
			
			spawn_unit = {
				province = ROOT
				home = ROOT
				owner = THIS
				leader = THIS
				scaled_by_biggest_garrison = 2.0
				troops = {
					archers = { 6 6 }
					light_cavalry = { 3 3 }
					knights = { 1 1 }
					light_infantry = { 7 7 }
					heavy_infantry = { 3 3 }
				}
				attrition = 1.0
			}
			
			create_character = {
				random_traits = yes
				dynasty = none
				religion = ROOT
				culture = ROOT
				female = no
				age = 34
				attributes = {
					martial = 7
				}
				trait = skilled_tactician
			}
			new_character = {
				spawn_unit = {
					province = ROOT
					home = ROOT
					owner = PREV
					leader = THIS
					scaled_by_biggest_garrison = 2.0
					troops = {
						archers = { 6 6 }
						light_cavalry = { 3 3 }
						knights = { 1 1 }
						light_infantry = { 7 7 }
						heavy_infantry = { 3 3 }
					}
				}
			}
			
			create_character = {
				random_traits = yes
				dynasty = none
				religion = ROOT
				culture = ROOT
				female = no
				age = 23
				attributes = {
					martial = 7
				}
				trait = skilled_tactician
			}
			new_character = {
				spawn_unit = {
					province = ROOT
					home = ROOT
					owner = PREV
					leader = THIS
					scaled_by_biggest_garrison = 2.0
					troops = {
						archers = { 6 6 }
						light_cavalry = { 3 3 }
						knights = { 1 1 }
						light_infantry = { 7 7 }
						heavy_infantry = { 3 3 }
					}
				}
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = liberation_revolt
							thirdparty_title = ROOT # The county...
							tier = KING # ... but really the de jure kingdom
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1041
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1040"
	}
}

character_event = {
	id = TOG.1041
	desc = EVTDESC_TOG_1041
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TOG_1040
	}
}

# Nationalists seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = TOG.1045
	picture = GFX_evt_siege
	
	hide_window = yes
	is_triggered_only = yes
	
	desc = OK
	
	trigger = {
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
		any_war = {
			attacker = { character = ROOT }
			using_cb = liberation_revolt
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { culture = ROOT }
						kingdom = { culture = ROOT }
					}
					random = {
						chance = 20
						culture = ROOT
					}
				}
				if = {
					limit = {
						culture = ROOT
						NOT = { has_province_modifier = cultural_unrest }
					}
					add_province_modifier = {
						name = cultural_unrest
						duration = 730
					}
				}
			}
		}
	}
	
	option = {
		name = OK
	}
}

# Nationalist Rebels rise up to reinforce an ongoing revolt
# Triggered from "on_rebel_revolt"
province_event = {
	id = TOG.1050
	desc = EVTDESC_TOG_1050
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		has_dlc = "The Old Gods"
		
		# There is already an ongoing nationalist revolt for the same kingdom
		owner = {
			top_liege = {
				war = yes
				any_war = {
					defender = { character = PREV }
					using_cb = liberation_revolt
					thirdparty_title_scope = {
						ROOT = {
							kingdom = {
								title = PREVPREV
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = liberation_revolt
						thirdparty_title_scope = {
							ROOT = {
								kingdom = {
									title = PREVPREV
								}
							}
						}
					}
					attacker = {
						create_character = {
							random_traits = yes
							dynasty = none
							religion = ROOT
							culture = ROOT
							female = no
							age = 24
							attributes = {
								martial = 7
							}
							trait = skilled_tactician
						}
						new_character = {
							spawn_unit = {
								province = ROOT
								home = ROOT
								owner = PREV
								leader = THIS
								scaled_by_biggest_garrison = 2.0
								troops = {
									archers = { 6 6 }
									light_cavalry = { 3 3 }
									knights = { 1 1 }
									light_infantry = { 7 7 }
									heavy_infantry = { 3 3 }
								}
							}
						}
						create_character = {
							random_traits = yes
							dynasty = none
							religion = ROOT
							culture = ROOT
							female = no
							age = 27
							attributes = {
								martial = 7
							}
							trait = skilled_tactician
						}
						new_character = {
							spawn_unit = {
								province = ROOT
								home = ROOT
								owner = PREV
								leader = THIS
								scaled_by_biggest_garrison = 2.0
								troops = {
									archers = { 6 6 }
									light_cavalry = { 3 3 }
									knights = { 1 1 }
									light_infantry = { 7 7 }
									heavy_infantry = { 3 3 }
								}
							}
						}
						create_character = {
							random_traits = yes
							dynasty = none
							religion = ROOT
							culture = ROOT
							female = no
							age = 30
							attributes = {
								martial = 7
							}
							trait = skilled_tactician
						}
						new_character = {
							spawn_unit = {
								province = ROOT
								home = ROOT
								owner = PREV
								leader = THIS
								scaled_by_biggest_garrison = 2.0
								troops = {
									archers = { 6 6 }
									light_cavalry = { 3 3 }
									knights = { 1 1 }
									light_infantry = { 7 7 }
									heavy_infantry = { 3 3 }
								}
							}
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1051
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

