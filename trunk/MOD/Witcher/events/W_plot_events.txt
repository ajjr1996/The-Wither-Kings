namespace = plots

###########################################
# Curse a character
###########################################
# Hidden - decide which narrative event to use
character_event = {
	id = plots.1
	desc = "Decide which narrative event to use"
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_intrigue
	
	hide_window = yes
	
	only_rulers = yes
	min_age = 15
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_plot = plot_curse_character
	}
	
	mean_time_to_happen = {
		days = 30
	}
	
	option = {
		name = "Ruler is a Spider cultist"
		trigger = {
			religion = spider
		}
		ai_chance = {
			factor = 100
			modifier = { factor = 100 has_character_flag = made_sacrifice }
		}
		character_event = { id = plots.10 }
	}
	
	option = {
		name = "Ruler is a witch"
		trigger = { 
			trait = witch
		}
		ai_chance = {
			factor = 5000
			modifier = { factor = 0.1 has_character_modifier = drained }
		}
		character_event = { id = plots.20 }
	}
	
	option = {
		name = "Court magician is a witch"
		trigger = {
			job_mage = { trait = witch }
		}
		ai_chance = { factor = 1000 }
		character_event = { id = plots.30 }
	}
	
	option = {
		name = "None of the conditions is met any longer"
		ai_chance = { factor = 1 }
		character_event = { id = plots.40 }
	}
}
# Ruler is Spider cultist
character_event = {
	id = plots.10
	desc = EVTDESCplots.10
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAplots.10
		trigger = {
			has_character_flag = made_sacrifice
		}
		clr_character_flag = made_sacrifice
		plot_target_char = { set_character_flag = cursed }
	}
	option = {
		name = EVTOPTBplots.10
		trigger = {
			NOT = { has_character_flag = made_sacrifice }
		}
		character_event = { id = plots.11 }
	}
}
# Ruler is Spider cultist - had no sacrifice
character_event = {
	id = plots.11
	desc = EVTDESCplots.11
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAplots.11
		set_character_flag = cursed
		set_character_flag = abort_curse
	}
}
# Ruler is a witch
character_event = {
	id = plots.20
	desc = EVTDESCplots.20
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAplots.20
		plot_target_char = { set_character_flag = cursed }
		add_character_modifier = {
			name = drained
			duration = 200
		}
	}
}
# Court magician is a witch
character_event = {
	id = plots.30
	desc = EVTDESCplots.30
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAplots.30
		job_mage = {
			add_character_modifier = {
				name = drained
				duration = 200
			}
		}
		plot_target_char = { set_character_flag = cursed }
	}
}
# None of the conditions is met any longer
character_event = {
	id = plots.40
	desc = EVTDESCplots.40
	picture = GFX_evt_shadowy_cabal
	border = GFX_event_normal_frame_intrigue
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAplots.40
		set_character_flag = abort_curse
	}
}