namespace = witcher
################################################
# Witcher moving around
################################################
# Witcher  - Ask ask the liege permision to leave his court
character_event = {
	id = witcher.1
	desc = EVTDESCwitcher.1
	picture = GFX_evt_lunatic
	
	ai = yes
	min_age = 15
	capable_only = yes
	prisoner = no
	
	trigger = {
		trait = witcher
		in_command = no
		NOT = { has_character_modifier = recent_witcher_work }
	}
	
	mean_time_to_happen = { 
		months = 12
		modifier = { factor = 2 has_minor_title = title_court_witcher }
		modifier = { factor = 2 war = yes }
		modifier = {
			factor = 0.9
			liege = { NOT = { reverse_opinion = { who = ROOT value = -25 } } }
		}
		modifier = {
			factor = 0.9
			liege = { NOT = { reverse_opinion = { who = ROOT value = -50 } } }
		}
		modifier = {
			factor = 0.9
			liege = { NOT = { reverse_opinion = { who = ROOT value = -75 } } }
		}
		modifier = {
			factor = 1.4
			liege = { reverse_opinion = { who = ROOT value = 25 } }
		}
		modifier = {
			factor = 1.4
			liege = { reverse_opinion = { who = ROOT value = 50 } }
		}
		modifier = {
			factor = 1.4
			liege = { reverse_opinion = { who = ROOT value = 75 } }
		}
		modifier = {
			factor = 3
			liege = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_asked_to_stay } }
		}
		modifier = {
			factor = 10
			liege = {
				any_demesne_province = {
					OR = {
						has_province_modifier = vampires
						has_province_modifier = werewolves
						has_province_modifier = kikimoras
						has_province_modifier = hellhounds
						has_province_modifier = rotfiends
						has_province_modifier = drowners
						has_province_modifier = nekkers
					}
				}
			}
		}
		modifier = {
			factor = 0.5
			any_playable_ruler = { has_character_flag = invited_witcher }
		}
	}
	
	option = {
		name = EVTOPTAwitcher.1
		liege = { character_event = { id = witcher.2 } }
	}
}
# Liege - The witcher has informed you of his desire to leave your court
character_event = {
	id = witcher.2
	desc = EVTDESCwitcher.2 
	picture = GFX_evt_lunatic
	
	is_triggered_only = yes
	
	option = { # Convince the witcher to stay
		name = EVTOPTAwitcher.2
		FROM = { character_event = { id = witcher.3 } }
	}
	option = { # Bribe the witcher to stay
		name = EVTOPTBwitcher.2
		FROM = { character_event = { id = witcher.4 } }
		transfer_scaled_wealth = {
			to = FROM
			value = 0.20
		}
	}
	option = { # Let him leave
		name = EVTOPTCwitcher.2
		FROM = { character_event = { id = witcher.5 } }
	}
}
# Witcher - Your liege wishes you to stay
character_event = {
	id = witcher.3
	desc = EVTDESCwitcher.3
	picture = GFX_evt_lunatic
	
	ai = yes
	is_triggered_only = yes
	
	option = { # Stay
		name = EVTOPTAwitcher.3
		ai_chance = {
			factor = 1
			modifier = { factor = 2 trait = content }
			modifier = { factor = 2 trait = slothful }
			modifier = { factor = 2 trait = patient }
			modifier = { factor = 3 has_opinion_modifier = { who = FROM modifier = opinion_friend } }
		}
		opinion = {
			who = FROM
			modifier = opinion_asked_to_stay
			months = 12
		}
		FROM = { character_event = { id = witcher.6 days = 3 } }
	}
	option = { # Leave
		name = EVTOPTBwitcher.3
		ai_chance = {
			factor = 3
		}
		character_event = { id = witcher.5 days = 3 }
	}
}
# Witcher - Your liege offers a bribe if you stay
character_event = {
	id = witcher.4
	desc = EVTDESCwitcher.4
	picture = GFX_evt_lunatic
	
	ai = yes
	is_triggered_only = yes
	
	option = { # Stay
		name = EVTOPTAwitcher.4
		ai_chance = {
			factor = 1
			modifier = { factor = 2 trait = greedy }
			modifier = { factor = 2 trait = content }
			modifier = { factor = 2 trait = slothful }
			modifier = { factor = 2 trait = patient }
			modifier = { factor = 3 has_opinion_modifier = { who = FROM modifier = opinion_friend } }
		}
		opinion = {
			who = FROM
			modifier = opinion_asked_to_stay
			months = 12
		}
		FROM = { character_event = { id = witcher.7 days = 3 } }
	}
	option = { # Leave
		ai_chance = {
			factor = 3
		}
		name = EVTOPTBwitcher.5
		character_event = { id = witcher.5 days = 3 }
	}
}
# Witcher - Leave to ...
character_event = {
	id = witcher.5
	desc = EVTDESCwitcher.5
	picture = GFX_evt_lunatic
	
	ai = yes
	is_triggered_only = yes
	
	immediate = {
		liege = { character_event = { id = witcher.8 } }
	}
	
	option = { # ... neighbor province with monster problems
		name = EVTOPTAwitcher.5
		trigger = {
			liege = {
				any_demesne_province = {
					any_neighbor_province = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
						OR = {
							has_province_modifier = vampires
							has_province_modifier = werewolves
							has_province_modifier = kikimoras
							has_province_modifier = hellhounds
							has_province_modifier = rotfiends
							has_province_modifier = drowners
							has_province_modifier = nekkers
						}
					}
				}
			}
		}
		liege = {
			random_demesne_province = {
				limit = {
					any_neighbor_province = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
						OR = {
							has_province_modifier = vampires
							has_province_modifier = werewolves
							has_province_modifier = kikimoras
							has_province_modifier = hellhounds
							has_province_modifier = rotfiends
							has_province_modifier = drowners
							has_province_modifier = nekkers
						}
					}
				}
				random_neighbor_province = {
					limit = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
						OR = {
							has_province_modifier = vampires
							has_province_modifier = werewolves
							has_province_modifier = kikimoras
							has_province_modifier = hellhounds
							has_province_modifier = rotfiends
							has_province_modifier = drowners
							has_province_modifier = nekkers
						}
					}
					owner = {
						reverse_banish = ROOT
						character_event = { id = witcher.9 }
					}
				}
			}
		}
		ai_chance = { factor = 100 }
	}
	option = { # ... random neighbor province where any witcher haven't recently visited
		name = EVTOPTBwitcher.5
		trigger = {
			liege = {
				any_demesne_province = {
					any_neighbor_province = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
						NOT = { has_province_modifier = monster_purge }
					}
				}
			}
		}
		liege = {
			random_demesne_province = {
				limit = {
					any_neighbor_province = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
						NOT = { has_province_modifier = monster_purge }
					}
				}
				random_neighbor_province = {
					limit = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
						NOT = { has_province_modifier = monster_purge }
					}
					owner = {
						reverse_banish = ROOT
						character_event = { id = witcher.9 }
					}
				}
			}
		}
		ai_chance = { factor = 10 }
	}
	option = { # ... random neighbor province 
		name = EVTOPTCwitcher.5
		liege = {
			random_demesne_province = {
				limit = {
					any_neighbor_province = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
					}
				}
				random_neighbor_province = {
					limit = {
						owner = {
							NOT = { character = liege }
							any_courtier = { NOT = { trait = witcher } }
						}
					}
					owner = {
						reverse_banish = ROOT
						character_event = { id = witcher.9 }
					}
				}
			}
		}
		ai_chance = { factor = 1 }
	}
	option = { # ... the court of a ruler who invited witcher
		name = EVTOPTDwitcher.5
		trigger = {
			any_playable_ruler = { has_character_flag = invited_witcher }
		}
		random_playable_ruler = {
			limit = {
				has_character_flag = invited_witcher
				any_courtier = { NOT = { trait = witcher } }
			}
			reverse_banish = ROOT
			character_event = { id = witcher.9 }
		}
		ai_chance = { factor = 1000 }
	}
}
# Liege informed - The witcher stayed
character_event = { 
	id = witcher.6
	desc = EVTDESCwitcher.6
	picture = GFX_evt_lunatic
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}
# Liege informed - The witcher took the money and stayed
character_event = {
	id = witcher.7
	desc = EVTDESCwitcher.7
	picture = GFX_evt_lunatic
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}
# Liege informed - The witcher left your court to seek employment elsewhere
character_event = {
	id = witcher.8
	desc = EVTDESCwitcher.8
	picture = GFX_evt_lunatic
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}
# Liege - A witcher has arrived in your court
character_event = {
	id = witcher.9
	desc = EVTDESCwitcher.9
	picture = GFX_evt_lunatic
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTAwitcher.9 # OK
		clr_character_flag = invited_witcher
	}
	option = {
		name = EVTOPTBwitcher.9 # I have no need for the witcher
		trigger = { NOT = { has_character_flag = invited_witcher } }
		FROM = { character_event = { id = witcher.5 } }
	}
}
################################################
# Witcher info decision
################################################
character_event = {
	id = witcher.100
	desc = EVTDESCwitcher.100
	picture = GFX_evt_lunatic
	
	is_triggered_only = yes
	
	immediate = {
		witcher = {
			limit = {
				is_alive = yes
			}
			set_character_flag = witcher_count_1
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
			}
			set_character_flag = witcher_count_2
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
			}
			set_character_flag = witcher_count_3
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
				NOT = { has_character_flag = witcher_count_3 }
			}
			set_character_flag = witcher_count_4
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
				NOT = { has_character_flag = witcher_count_3 }
				NOT = { has_character_flag = witcher_count_4 }
			}
			set_character_flag = witcher_count_5
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
				NOT = { has_character_flag = witcher_count_3 }
				NOT = { has_character_flag = witcher_count_4 }
				NOT = { has_character_flag = witcher_count_5 }
			}
			set_character_flag = witcher_count_6
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
				NOT = { has_character_flag = witcher_count_3 }
				NOT = { has_character_flag = witcher_count_4 }
				NOT = { has_character_flag = witcher_count_5 }
				NOT = { has_character_flag = witcher_count_6 }
			}
			set_character_flag = witcher_count_7
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
				NOT = { has_character_flag = witcher_count_3 }
				NOT = { has_character_flag = witcher_count_4 }
				NOT = { has_character_flag = witcher_count_5 }
				NOT = { has_character_flag = witcher_count_6 }
				NOT = { has_character_flag = witcher_count_7 }
			}
			set_character_flag = witcher_count_8
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
				NOT = { has_character_flag = witcher_count_3 }
				NOT = { has_character_flag = witcher_count_4 }
				NOT = { has_character_flag = witcher_count_5 }
				NOT = { has_character_flag = witcher_count_6 }
				NOT = { has_character_flag = witcher_count_7 }
				NOT = { has_character_flag = witcher_count_8 }
			}
			set_character_flag = witcher_count_9
		}
		witcher = {
			limit = {
				is_alive = yes
				NOT = { has_character_flag = witcher_count_1 }
				NOT = { has_character_flag = witcher_count_2 }
				NOT = { has_character_flag = witcher_count_3 }
				NOT = { has_character_flag = witcher_count_4 }
				NOT = { has_character_flag = witcher_count_5 }
				NOT = { has_character_flag = witcher_count_6 }
				NOT = { has_character_flag = witcher_count_7 }
				NOT = { has_character_flag = witcher_count_8 }
				NOT = { has_character_flag = witcher_count_9 }
			}
			set_character_flag = witcher_count_10
		}
	}
	
	option = {
		name = EVTOPTAwitcher.100
		witcher = { limit = { has_character_flag = witcher_count_1 } clr_character_flag = witcher_count_1 }
		witcher = { limit = { has_character_flag = witcher_count_2 } clr_character_flag = witcher_count_2 }
		witcher = { limit = { has_character_flag = witcher_count_3 } clr_character_flag = witcher_count_3 }
		witcher = { limit = { has_character_flag = witcher_count_4 } clr_character_flag = witcher_count_4 }
		witcher = { limit = { has_character_flag = witcher_count_5 } clr_character_flag = witcher_count_5 }
		witcher = { limit = { has_character_flag = witcher_count_6 } clr_character_flag = witcher_count_6 }
		witcher = { limit = { has_character_flag = witcher_count_7 } clr_character_flag = witcher_count_7 }
		witcher = { limit = { has_character_flag = witcher_count_8 } clr_character_flag = witcher_count_8 }
		witcher = { limit = { has_character_flag = witcher_count_9 } clr_character_flag = witcher_count_9 }
		witcher = { limit = { has_character_flag = witcher_count_10 } clr_character_flag = witcher_count_10 }
	}
}

################################################
# Witcher generic monster hunting
################################################
#Witcher
character_event = {
	id = witcher.200
	desc = EVTDESCwitcher.200
	picture = GFX_evt_lunatic
		
	ai = yes
	min_age = 15
	capable_only = yes
	prisoner = no
	
	trigger = {
		trait = witcher
		in_command = no
		liege = {
			any_demesne_province = {
				OR = {
					has_province_modifier = vampires
					has_province_modifier = werewolves
					has_province_modifier = kikimoras
					has_province_modifier = hellhounds
					has_province_modifier = rotfiends
					has_province_modifier = drowners
					has_province_modifier = nekkers
				}
			}
		}
	}
	
	mean_time_to_happen = { 
		days = 30
		modifier = { factor = 0.8 has_minor_title = title_court_witcher }
		modifier = { factor = 0.8 trait = diligent }
		modifier = { factor = 2 trait = slothful }
	}
	
	option = {
		name = EVTDESCwitcher.200
		liege = {
			random_demesne_province = {
				limit = {
					OR = {
						has_province_modifier = vampires
						has_province_modifier = werewolves
						has_province_modifier = kikimoras
						has_province_modifier = hellhounds
						has_province_modifier = rotfiends
						has_province_modifier = drowners
						has_province_modifier = nekkers
					}
				}
				province_event = { id = witcher.201 }
			}
		}
	}
}
#Province
province_event = {
	id = witcher.201
	desc = EVTDESCwitcher.201
	picture = GFX_evt_lunatic
	
	notification = yes
	
	is_triggered_only = yes
	
	immediate = {
		remove_province_modifier = vampires
		remove_province_modifier = werewolves
		remove_province_modifier = kikimoras
		remove_province_modifier = hellhounds
		remove_province_modifier = rotfiends
		remove_province_modifier = drowners
		remove_province_modifier = nekkers
		add_province_modifier = { name = monster_purge duration = 360 }
		FROM = { add_character_modifier = { name = recent_witcher_work duration = 180 } }
	}
	option = {
		name = OK
	}
}