# Dynasty decisions are listed for each living dynasty member. The ruler is in the FROM scope.

dynasty_decisions = {

	legitimize_bastard = {
		from_potential = {
			NOT = { culture = wilderness }
			is_playable = yes
		}
		
		potential = {
			NOT = { culture = wilderness }
			trait = bastard
			is_child_of = FROM
			is_liege_or_above = FROM
		}
		allow = {
			FROM = { piety = 20 }
		}
		effect = {
			dynasty = FROM
			remove_trait = bastard
			add_trait = legit_bastard
			recalc_succession = yes
			FROM = { piety = -20 }
			if = {
				limit = {
					prisoner = yes
					host = { character = FROM }
				}
				imprison = no
			}
			
			mother = {
				opinion = {
					who = FROM
					modifier = legitimized_child
					years = 10
				}
			}
			FROM = {
				spouse = {
					if = {
						limit = {
							NOT = {
								any_child = {
									character = ROOT
								}	
							}
						}
						opinion = {
							who = FROM
							modifier = legitimized_bastard
							years = 20
						}
					}
				}
				any_child = {
					limit = {
						NOT = { character = ROOT }
						dynasty = FROM
						NOT = { trait = bastard }
					}
					opinion = {
						who = FROM
						modifier = legitimized_bastard
						months = 12
					}
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			# Better child first
			modifier = { factor = 0.1 trait = imbecile }
			modifier = { factor = 0.75 trait = slow }
			modifier = { factor = 0.5 trait = inbred }
			modifier = { factor = 0.5 trait = lunatic }
			modifier = { factor = 1.5 trait = quick }
			modifier = { factor = 2 trait = genius }
			modifier = { factor = 2 trait = elusive_shadow }
			modifier = { factor = 2 trait = grey_eminence }
			modifier = { factor = 2 trait = midas_touched }
			modifier = { factor = 2 trait = brilliant_strategist }
			modifier = { factor = 2 trait = mastermind_theologian }
			modifier = { factor = 2 trait = the_sage }
			modifier = { factor = 0.5 trait = amateurish_plotter }
			modifier = { factor = 0.5 trait = naive_appeaser }
			modifier = { factor = 0.5 trait = indulgent_wastrel }
			modifier = { factor = 0.5 trait = misguided_warrior }
			modifier = { factor = 0.5 trait = detached_priest }
			modifier = { factor = 0.5 trait = scatterbrain }
			modifier = { factor = 1.5 trait = strong }
			modifier = { factor = 1.5 trait = fair }
			modifier = { factor = 0.75 trait = ugly }
			modifier = { factor = 0.75 trait = weak }
			modifier = { factor = 0.1 is_female = yes }
			modifier = {
				factor = 2
				is_adult = yes
				NOT = { has_character_modifier = old_age}
			}
			# More likely if old
			modifier = {
				factor = 10
				FROM = { has_character_modifier = old_age }
			}
			# Not when have legit child
			modifier = {
				factor = 0
				FROM = {
					any_child = {
						NOT = { trait = bastard }
						dynasty = ROOT
						is_female = no
					}
				}
			}
		}
	}
}
